#=======================================================================================
#=== DESCIPTION ========================================================================
#=======================================================================================
	## Checks for files and what not
	## (the core commands were from the stuff in #operationscenter)
	## 
#=======================================================================================
#=======================================================================================
	#
	#*************** NEED TO DO/ADD ***********************
	# 
	#******************************************************
	#
#///////////////////////////////////////////////////////////////////////////////////////
#|||||||||||||||||||||||| Script Stuff Starts |||||||||||||||||||||||||||||||||||||||||
#\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
(
gap="$(printf %4s | tr " " "=")"
note="$(printf %3s | tr " " "\`")"
function title { 
	printf "%s""\n$gap ${1} $gap\n";
};

printf "\n\n$note"
title "Host Info"
printf "[Hostname]\t$(hostname)"
printf "\n[     IPs]\t$(hostname -I|column -t)"
printf "\n[    Time]\t$(date)\n\n"

title "Bad Files"
printf "$(for F in $(ldd $(which sshd)  | cut -d '>' -f2 | grep -oE '/[^ ]+'); do if ! rpm -qf $F --quiet ; then echo "Bad $F" ; fi  ; done)\n\n"

title "Some details on '/etc/ld.so.preload'"
printf "[    File Contents]\t$(cat /etc/ld.so.preload)"
printf "\n[Checksum (SHA256)]\t$(sha256sum /lib/libgrubd.so)\n\n"

title "Version Info"
printf "[  Exim]\t$(rpm -qa |grep exim)"
printf "\n[cPanel]\t$(cat /usr/local/cpanel/version)\n\n"

title "Misc"
printf "%s\n" "['wget' hits from root in exim_mainlog]"
printf "\t$(grep run /var/log/exim_mainlog | grep root | grep wget -c)\n"

printf "\n[Trying to access crontab]"
printf "$(crontab -u root -l)"

printf "$note\n\n"
)

#-----------------------------------
# one-liner variant
(gap="$(printf %4s | tr " " "=")";note="$(printf %3s | tr " " "\`")";function title { printf "%s""\n$gap ${1} $gap\n"; };printf "\n\n$note";title "Host Info";printf "[Hostname]\t$(hostname)";printf "\n[     IPs]\t$(hostname -I|column -t)";printf "\n[    Time]\t$(date)\n\n";title "Bad Files";printf "$(for F in $(ldd $(which sshd)  | cut -d '>' -f2 | grep -oE '/[^ ]+'); do if ! rpm -qf $F --quiet ; then echo "Bad $F" ; fi  ; done)\n\n";title "Some details on '/etc/ld.so.preload'";printf "[    File Contents]\t$(cat /etc/ld.so.preload)";printf "\n[Checksum (SHA256)]\t$(sha256sum /lib/libgrubd.so)\n\n";title "Version Info";printf "[  Exim]\t$(rpm -qa |grep exim)";printf "\n[cPanel]\t$(cat /usr/local/cpanel/version)\n\n";title "Misc";printf "%s\n" "['wget' hits from root in exim_mainlog]";printf "\t$(grep run /var/log/exim_mainlog | grep root | grep wget -c)\n";printf "\n[Trying to access crontab]";printf "$(crontab -u root -l)\n";printf "$note\n\n")
